var a=class{static getDpi(){return window.devicePixelRatio}static start(e){return a.lastDpi=window.devicePixelRatio,a.timerId=window.setInterval(a.update,1e3),a.callback=e,a.lastDpi}static stop(){window.clearInterval(a.timerId),a.callback=void 0}static update(){if(!a.callback)return;let e=window.devicePixelRatio,t=a.lastDpi;a.lastDpi=e,Math.abs(t-e)>.001&&a.callback.invokeMethod("Invoke",t,e)}};var c=class{static clear(e){e.value=""}static isInputElement(e){return e.setSelectionRange!==void 0}static focus(e){e.focus(),this.isInputElement(e)&&e.setSelectionRange(0,0)}static setCursor(e,t){e.style.cursor=t}static hide(e){e.style.display="none"}static show(e){e.style.display="block"}};var m=class{static CreateDefaultChild(e){return document.createElement("div")}static GetReference(e){return e}static CreateAttachment(){return new u}},u=class{InitializeWithChildHandle(e){this._child=e,this._child.style.position="absolute"}AttachTo(e){this._host&&this._child&&this._host.removeChild(this._child),this._host=e,this._host&&this._child&&this._host.appendChild(this._child)}ShowInBounds(e,t,n,i){this._child&&(this._child.style.top=t+"px",this._child.style.left=e+"px",this._child.style.width=n+"px",this._child.style.height=i+"px",this._child.style.display="block")}HideWithSize(e,t){this._child&&(this._child.style.width=e+"px",this._child.style.height=t+"px",this._child.style.display="none")}ReleaseChild(){this._child&&(this._child=void 0)}};var s=class{static observe(e,t,n){if(!e||!n)return;s.init();let i=e;i.SizeWatcher={callback:n},s.elements.set(t,e),s.observer.observe(e),s.invoke(e)}static unobserve(e){if(!e||!s.observer)return;let t=s.elements.get(e);s.elements.delete(e),s.observer.unobserve(t)}static init(){s.observer||(s.elements=new Map,s.observer=new ResizeObserver(e=>{for(let t of e)s.invoke(t.target)}))}static invoke(e){let n=e.SizeWatcher;if(!(!n||!n.callback))return n.callback.invokeMethod("Invoke",e.clientWidth,e.clientHeight)}};var l=class{constructor(e,t,n){this.renderLoopEnabled=!1;this.renderLoopRequest=0;if(this.htmlCanvas=t,this.renderFrameCallback=n,e){let i=l.createWebGLContext(this.htmlCanvas);if(!i){console.error(`Failed to create WebGL context: err ${i}`);return}GL.makeContextCurrent(i);let r=GLctx.getParameter(GLctx.FRAMEBUFFER_BINDING);this.glInfo={context:i,fboId:r?r.id:0,stencil:GLctx.getParameter(GLctx.STENCIL_BITS),sample:0,depth:GLctx.getParameter(GLctx.DEPTH_BITS)}}}static initGL(e,t,n){var i=l.init(!0,e,t,n);return!i||!i.glInfo?null:i.glInfo}static initRaster(e,t,n){var i=l.init(!1,e,t,n);return!!i}static init(e,t,n,i){var r=t;if(!r)return console.error("No canvas element was provided."),null;l.elements||(l.elements=new Map),l.elements.set(n,t);let o=new l(e,t,i);return r.SKHtmlCanvas=o,o}static deinit(e){if(!e)return;let t=l.elements.get(e);l.elements.delete(e);let n=t;!n||!n.SKHtmlCanvas||(n.SKHtmlCanvas.deinit(),n.SKHtmlCanvas=void 0)}static requestAnimationFrame(e,t){let n=e;!n||!n.SKHtmlCanvas||n.SKHtmlCanvas.requestAnimationFrame(t)}static setCanvasSize(e,t,n){let i=e;!i||!i.SKHtmlCanvas||i.SKHtmlCanvas.setCanvasSize(t,n)}static setEnableRenderLoop(e,t){let n=e;!n||!n.SKHtmlCanvas||n.SKHtmlCanvas.setEnableRenderLoop(t)}static putImageData(e,t,n,i){let r=e;!r||!r.SKHtmlCanvas||r.SKHtmlCanvas.putImageData(t,n,i)}deinit(){this.setEnableRenderLoop(!1)}setCanvasSize(e,t){this.newWidth=e,this.newHeight=t,this.htmlCanvas.width!=this.newWidth&&(this.htmlCanvas.width=this.newWidth),this.htmlCanvas.height!=this.newHeight&&(this.htmlCanvas.height=this.newHeight),this.glInfo&&GL.makeContextCurrent(this.glInfo.context)}requestAnimationFrame(e){e!==void 0&&this.renderLoopEnabled!==e&&this.setEnableRenderLoop(e),this.renderLoopRequest===0&&(this.renderLoopRequest=window.requestAnimationFrame(()=>{this.glInfo&&GL.makeContextCurrent(this.glInfo.context),this.htmlCanvas.width!=this.newWidth&&(this.htmlCanvas.width=this.newWidth||0),this.htmlCanvas.height!=this.newHeight&&(this.htmlCanvas.height=this.newHeight||0),this.renderFrameCallback.invokeMethod("Invoke"),this.renderLoopRequest=0,this.renderLoopEnabled&&this.requestAnimationFrame()}))}setEnableRenderLoop(e){this.renderLoopEnabled=e,e?this.requestAnimationFrame():this.renderLoopRequest!==0&&(window.cancelAnimationFrame(this.renderLoopRequest),this.renderLoopRequest=0)}putImageData(e,t,n){if(this.glInfo||!e||t<=0||t<=0)return!1;var i=this.htmlCanvas.getContext("2d");if(!i)return console.error("Failed to obtain 2D canvas context."),!1;this.htmlCanvas.width=t,this.htmlCanvas.height=n;var r=new Uint8ClampedArray(Module.HEAPU8.buffer,e,t*n*4),o=new ImageData(r,t,n);return i.putImageData(o,0,0),!0}static createWebGLContext(e){let t={alpha:1,depth:1,stencil:8,antialias:0,premultipliedAlpha:1,preserveDrawingBuffer:0,preferLowPowerToHighPerformance:0,failIfMajorPerformanceCaveat:0,majorVersion:2,minorVersion:0,enableExtensionsByDefault:1,explicitSwapControl:0,renderViaOffscreenBackBuffer:1},n=GL.createContext(e,t);return!n&&t.majorVersion>1&&(console.warn("Falling back to WebGL 1.0"),t.majorVersion=1,t.minorVersion=0,n=GL.createContext(e,t)),n}};export{a as DpiWatcher,c as InputHelper,m as NativeControlHost,l as SKHtmlCanvas,s as SizeWatcher};
//# sourceMappingURL=Avalonia.js.map
